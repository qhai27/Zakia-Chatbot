/* Consolidated CSS for Zakia Chatbot (single file) */
@import url('https://fonts.googleapis.com/css2?family=Gabarito:wght@400;500;600;700&display=swap');

:root{
  --bg-grad: linear-gradient(135deg, #f3f7f5, #eaf5ef);
  --primary: #157347;
  --bot-bg: #5DB996;
  --user-bg: #CFE6DA;
  --bot-text: #ffffff;
  --user-text: #424242;
  --muted: #9E9E9E;
  --card-shadow: 0 10px 30px rgba(0,0,0,0.12);
  --radius: 20px;
  --gap: 12px;
  --max-chat-width: 420px;
  --font: "Gabarito";
  --anim-fast: 0.12s;
  --anim-normal: 0.28s;
  --anim-slow: 0.9s;
  --shimmer-duration: 3.8s;
}

*{box-sizing:border-box;margin:0;padding:0}
html,body{height:100%;font-family:var(--font)}
body{
  min-height:100vh;
  display:flex;
  justify-content:flex-end;
  align-items:center;
  padding-right:30px;
  background:var(--bg-grad);
  color:#111827;
}

/* Chat container */
.chatbox{
  width:100%;
  max-width:var(--max-chat-width);
  height:100vh;
  max-height:900px;
  min-height:500px;
  background:#fff;
  border-radius:var(--radius);
  box-shadow:var(--card-shadow);
  overflow:hidden;
  display:flex;
  flex-direction:column;
  transition:max-height .3s ease, height .2s ease;
}

/* Header */
.header{
  background:linear-gradient(90deg, rgba(21,115,71,0.95), rgba(21,115,71,0.92));
  color:#fff;
  padding:16px 18px;
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:12px;
  backdrop-filter:blur(2px);
}
.header-left{display:flex;align-items:center;gap:10px}
.avatar{width:56px;height:56px;border-radius:50%;object-fit:cover}
.header-text h3{margin:0;font-size:1.25rem}
.header-text p{margin:0;opacity:.85;font-size:.9rem}

/* Minimize / End chat */
.minimize-btn{background:none;border:none;color:#fff;font-size:20px;font-weight:700;cursor:pointer;padding:6px 8px;border-radius:6px;transition:background .2s,transform .06s}
.minimize-btn:hover{background:rgba(255,255,255,0.08)}
.minimize-btn:focus{outline:2px solid rgba(255,255,255,0.12);outline-offset:2px}
.end-chat-section{background:#fff;padding:8px 16px;display:flex;justify-content:flex-end;border-bottom:1px solid #eef3ef}
.btn-end{background:#C2185B;color:#fff;border:none;padding:8px 16px;border-radius:16px;font-size:12px;font-weight:500;cursor:pointer;transition:background .2s}
.btn-end:hover{background:#A0153E}


/* Main chat area */
.chat-container{flex:1 1 auto;display:flex;flex-direction:column;overflow:hidden;padding:0}
.date-indicator{display:flex;justify-content:center;padding:8px 0}
.date-chip{background:#FFD95F;color:#8B4513;padding:4px 12px;border-radius:12px;font-size:12px;font-weight:200}

/* Messages */
.messages{
  flex:1 1 auto;
  padding:16px;
  overflow-y:auto;
  display:flex;
  flex-direction:column;
  gap:12px;
  -webkit-overflow-scrolling:touch;
  background:radial-gradient(1200px 300px at 100% -20%, rgba(21,115,71,0.06), transparent 60%) no-repeat;
}
.msg{display:flex;align-items:flex-start;gap:8px;margin-bottom:8px}
.msg.user{justify-content:flex-end}
.msg.bot{justify-content:flex-start}

/* Bubble container/alignment */
.bubble-container{display:flex;flex-direction:column;width:100%;max-width:100%}
.msg.user .bubble-container{align-items:flex-end}
.msg.bot .bubble-container{align-items:flex-start}

/* Avatars */
.msg-avatar{width:32px;height:32px;border-radius:50%;object-fit:cover;background:#e0e0e0;flex-shrink:0}

/* Bubble core */
.bubble{
  display:inline-block;
  padding:12px 16px;
  border-radius:18px;
  font-size:14px;
  line-height:1.5;
  position:relative;
  box-shadow:0 2px 6px rgba(0,0,0,0.06);
  word-wrap:break-word;
  white-space:pre-wrap;
  overflow-wrap:anywhere;
  max-width: calc(100% - 96px); /* leaves room for avatar/gap */
}

/* bot bubble */
.msg.bot .bubble{
  background:var(--bot-bg);
  color:var(--bot-text);
  border-bottom-left-radius:4px;
  text-align:left;
  max-width: calc(100% - 96px);
}
.msg.bot .bubble::before{
  content:'';
  position:absolute;
  left:-8px;
  bottom:0;
  border-style:solid;
  border-width:0 8px 8px 0;
  border-color:transparent var(--bot-bg) transparent transparent;
}

/* user bubble */
.msg.user .bubble{
  background:var(--user-bg);
  color:var(--user-text);
  border-bottom-right-radius:4px;
  text-align:left;
  max-width:auto;  
  word-break:break-word;
  animation: bubbleIn .25s ease both, sendPulse 1.2s ease-out;
}

/* user tail */
.msg.user .bubble::before{
  content:'';
  position:absolute;
  right:-8px;
  bottom:0;
  border-style:solid;
  border-width:0 0 8px 8px;
  border-color:transparent transparent transparent var(--user-bg);
}


/* subtle animations */
@keyframes sendPulse{
  0%{box-shadow:0 0 0 0 rgba(93,185,150,0.28)}
  70%{box-shadow:0 0 0 10px rgba(93,185,150,0)}
  100%{box-shadow:0 0 0 0 rgba(93,185,150,0)}
}
@keyframes bubbleIn{
  0%{opacity:0;transform:translateY(10px) scale(.98)}
  100%{opacity:1;transform:translateY(0) scale(1)}
}

/* message time */
.msg-time{font-size:11px;color:var(--muted);margin-top:4px;padding:0 4px}

/* typing indicator */
.typing{display:flex;align-items:center;gap:8px;padding:0 16px 8px}
.typing.hidden{display:none}
.dot{width:6px;height:6px;background:#9dcfb4;border-radius:50%;display:inline-block;animation:blink 1.2s infinite}
.dot:nth-child(2){animation-delay:.15s}
.dot:nth-child(3){animation-delay:.3s}
@keyframes blink{0%,80%,100%{opacity:.2;transform:translateY(0)}40%{opacity:1;transform:translateY(-2px)}}

/* Quick replies */
.quick-replies{display:flex;flex-wrap:wrap;gap:8px;padding:8px 16px}
.quick-reply{background:#D9D9D9;border:none;color:#424242;padding:8px 12px;border-radius:16px;font-size:12px;font-weight:500;cursor:pointer}
.quick-reply:hover{background:#C4C4C4}
.quick-reply.selected{background:#BEDC74;color:#2E4A1B}

/* Input area */
.input-area{background:#fff;padding:12px 16px;display:flex;gap:8px;align-items:flex-end;border-top:1px solid #E0E0E0;flex-shrink:0}
.input-area textarea,.input-area input{
  flex:1;
  min-height:44px;
  max-height:220px;
  border:1px solid #E0E0E0;
  border-radius:20px;
  padding:10px 16px;
  outline:none;
  font-size:14px;
  resize:none;
  white-space:pre-wrap;
  overflow:auto;
}
.input-area textarea:focus,.input-area input:focus{border-color:var(--bot-bg);box-shadow:0 6px 16px rgba(93,185,150,0.06)}

.btn-send{background:transparent;border:none;width:56px;height:56px;padding:6px;border-radius:8px;display:inline-flex;align-items:center;justify-content:center;cursor:pointer;transition:opacity .12s,transform .06s; position: relative; overflow: hidden; }
.btn-send:hover{opacity:.94;transform:translateY(-2px)}
.btn-send:active{transform:translateY(0)}
.btn-send:disabled{opacity:.5;cursor:not-allowed}
.btn-send::after{
  content: "";
  position: absolute;
  width: 8px;
  height: 8px;
  background: rgba(255,255,255,0.12);
  border-radius: 50%;
  transform: scale(0);
  opacity: 0;
  pointer-events: none;
  left: 50%;
  top: 50%;
  transition: transform 420ms cubic-bezier(.2,.9,.3,1), opacity 300ms ease;
}
.btn-send:active::after{
  transform: translate(-50%,-50%) scale(24);
  opacity: 1;
  transition: transform 420ms cubic-bezier(.2,.9,.3,1), opacity 420ms ease;
}

.send-icon{width:36px;height:36px;object-fit:contain}

/* scrollbar */
.messages::-webkit-scrollbar{width:6px}
.messages::-webkit-scrollbar-track{background:#f1f1f1}
.messages::-webkit-scrollbar-thumb{background:#BDBDBD;border-radius:6px}
.messages::-webkit-scrollbar-thumb:hover{background:#9E9E9E}

/* minimized */
.chatbox.minimized{height:auto;max-height:84px;overflow:hidden}

/* floating widget */
#chatWidget{
  position:fixed;bottom:20px;right:20px;background:var(--primary);color:#fff;border-radius:50px;padding:12px 20px;display:flex;align-items:center;gap:12px;box-shadow:0 6px 25px rgba(21,115,71,0.3);cursor:pointer;z-index:1000;animation:slideIn .28s ease
}
#chatWidget:hover{transform:scale(1.04)}
.widget-avatar{width:48px;height:48px;border-radius:50%;object-fit:cover;border:2px solid #fff}
.widget-content{display:flex;flex-direction:column;gap:2px}
.widget-title{font-size:16px;font-weight:600;line-height:1}
.widget-subtitle{font-size:12px;opacity:.9;line-height:1}
@keyframes slideIn{from{transform:translateY(80px);opacity:0}to{transform:translateY(0);opacity:1}}
#chatWidget::after{content:'';position:absolute;top:8px;right:8px;width:12px;height:12px;background:#FF4444;border-radius:50%;border:2px solid var(--primary);animation:pulse 2s infinite;display:none}
#chatWidget.has-notification::after{display:block}
@keyframes pulse{0%,100%{opacity:1;transform:scale(1)}50%{opacity:.7;transform:scale(1.1)}}

/* --- UI Animation & Polishing --- */
/* animation variables */
:root{
  --anim-fast: 0.12s;
  --anim-normal: 0.28s;
  --anim-slow: 0.9s;
  --shimmer-duration: 3.8s;
}

/* message entrance (subtle stagger-like feel when messages render) */
.messages .msg{
  opacity: 0;
  transform: translateY(8px) scale(.997);
  animation: msgIn var(--anim-normal) cubic-bezier(.2,.9,.3,1) forwards;
}
@keyframes msgIn{
  from { opacity: 0; transform: translateY(8px) scale(.997); }
  to   { opacity: 1; transform: translateY(0) scale(1); }
}

/* gentle hover / focus for bubbles */
.bubble{
  transition: transform var(--anim-fast) ease, box-shadow var(--anim-fast) ease, filter var(--anim-fast) ease;
}
.bubble:hover{
  transform: translateY(-2px) scale(1.01);
  box-shadow: 0 8px 28px rgba(16,24,40,0.10);
  filter: saturate(1.03);
}

/* stronger emphasis for user-sent animation (pulse shortly after send) */
.msg.user .bubble.sendPulseAnim{
  animation: sendPop 420ms cubic-bezier(.2,.9,.3,1);
}
@keyframes sendPop{
  0%   { transform: translateY(0) scale(0.98); box-shadow:0 2px 8px rgba(0,0,0,0.04); }
  60%  { transform: translateY(-6px) scale(1.02); box-shadow:0 12px 30px rgba(0,0,0,0.08); }
  100% { transform: translateY(0) scale(1); }
}

/* bot bubble shimmer ‚Äî subtle moving light to make replies feel alive */
.msg.bot .bubble{
  position: relative; /* ensure pseudo-element aligns */
  overflow: hidden;
}
.msg.bot .bubble::after{
  content: "";
  position: absolute;
  inset: 0;
  background: linear-gradient(90deg, rgba(255,255,255,0.00) 0%, rgba(255,255,255,0.08) 45%, rgba(255,255,255,0.00) 100%);
  transform: translateX(-120%);
  pointer-events: none;
  opacity: 0.6;
  mix-blend-mode: soft-light;
  animation: shimmer var(--shimmer-duration) linear infinite;
}
@keyframes shimmer{
  0%{ transform: translateX(-120%); }
  100%{ transform: translateX(120%); }
}

/* improved typing indicator animation */
.typing .dot{
  width:7px;height:7px;border-radius:50%;
  background:rgba(241, 227, 68, 0.85);
  box-shadow:0 2px 6px rgba(0,0,0,0.06);
  opacity:0.85;
  transform: translateY(0);
  animation: typingBounce 1s infinite ease-in-out;
}
.typing .dot:nth-child(2){ animation-delay: .12s; }
.typing .dot:nth-child(3){ animation-delay: .24s; }
@keyframes typingBounce{
  0%   { transform: translateY(0); opacity:.6 }
  30%  { transform: translateY(-6px); opacity:1 }
  60%  { transform: translateY(0); opacity:.8 }
  100% { transform: translateY(0); opacity:.6 }
}

/* unread / new message badge for floating widget */
#chatWidget .badge{
  position: absolute;
  top: 8px;
  right: 8px;
  min-width: 18px;
  height: 18px;
  padding: 0 6px;
  background: #FF5252;
  color: #fff;
  border-radius: 12px;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:11px;
  font-weight:600;
  box-shadow: 0 6px 18px rgba(255,82,82,0.18);
  transform-origin: center;
  animation: badgePulse 1600ms infinite ease-in-out;
}
@keyframes badgePulse{
  0%{ transform: scale(1); opacity: 1; }
  60%{ transform: scale(1.06); opacity: .9; }
  100%{ transform: scale(1); opacity: 1; }
}

/* subtle glass-like backdrop inside chatbox header (needs supported browsers) */
.header{
  background: linear-gradient(90deg, rgba(21,115,71,0.95), rgba(21,115,71,0.92));
  backdrop-filter: blur(2px);
}

/* responsive tweak: reduce animation intensity on small screens for perf */
@media (max-width:480px){
  .messages .msg{ animation-duration: calc(var(--anim-normal) * 0.9); }
  .msg.bot .bubble::after{ animation-duration: calc(var(--shimmer-duration) * 1.2); }
}

.messages .msg.no-anim{ animation: none !important; opacity:1; transform:none !important; }

/* Responsive tweaks */
@media (max-width:768px){
  :root{--max-chat-width:100%}
  body{padding:12px}
  .chatbox{height:90vh;border-radius:16px}
  .header{padding:10px 12px}
  .header-text h3{font-size:.9rem}
  .messages{padding:14px}
  .bubble{max-width:85%;font-size:13px;padding:10px 14px}
  .quick-reply{font-size:11px;padding:6px 10px}
  .input-area{padding:10px 14px}
  .btn-send{width:40px;height:40px}
}

@media (max-width:480px){
  body{padding:0;align-items:stretch}
  .chatbox{max-width:100%;height:100vh;border-radius:0;box-shadow:none}
  .header{padding:12px 16px;border-radius:0}
  .avatar{width:40px;height:40px}
  .messages{padding:12px 16px;gap:10px}
  .bubble{max-width:calc(100% - 72px);font-size:14px;padding:12px 16px}
  .msg-avatar{width:28px;height:28px}
  .input-area{padding:12px 16px;gap:8px}
  .btn-send{width:36px;height:36px}
  .date-chip{font-size:11px;padding:3px 10px}
  .chatbox{min-height:100vh}
}

@media (max-width:375px){
  .header{padding:10px 14px}
  .avatar{width:36px;height:36px}
  .messages{padding:10px 14px}
  .bubble{max-width:90%;font-size:13px;padding:10px 14px}
  .quick-reply{font-size:10px;padding:5px 8px}
  .input-area{padding:10px 14px}
  .btn-send{width:32px;height:32px}
}

/* Minimize button ‚Äî rotate 180¬∞ on hover with smooth scale */
.minimize-btn{
  transition: transform .36s cubic-bezier(.2,.9,.3,1), box-shadow .18s, background .18s;
  transform-origin: center;
  will-change: transform;
}
.minimize-btn:hover{
  transform: rotate(180deg) scale(1.08);
  box-shadow: 0 10px 22px rgba(21,115,71,0.14);
}
.minimize-btn:active{
  transform: rotate(180deg) scale(0.98);
}

/* Floating widget ‚Äî continuous float, wiggle on hover, avatar pulse & scale on hover */
#chatWidget{
  /* keep slideIn and add continuous float */
  animation: slideIn .28s ease, widgetFloat 6s ease-in-out infinite;
  transition: transform .18s ease, box-shadow .18s ease;
  will-change: transform;
  position: fixed;
  bottom: 20px;
  right: 20px;
}

/* hover: wiggle + lift + scale */
#chatWidget:hover{
  animation: slideIn .28s ease, widgetFloat 6s ease-in-out infinite, widgetWiggle .7s ease-in-out;
  transform: translateY(-8px) scale(1.06);
  box-shadow: 0 16px 40px rgba(21,115,71,0.28);
}

/* visual ring for notification (keeps existing .has-notification behavior) */
#chatWidget.has-notification::before{
  content: "";
  position: absolute;
  left: 50%;
  top: 50%;
  transform: translate(-50%,-50%);
  width: 140%;
  height: 140%;
  border-radius: 999px;
  pointer-events: none;
  z-index: -1;
  background: radial-gradient(circle at center, rgba(93,185,150,0.12) 0%, rgba(93,185,150,0.04) 30%, transparent 60%);
  animation: widgetRing 1.8s ease-out infinite;
}

/* avatar pulse (glow) + scale on hover of the widget */
.widget-avatar{
  width:48px;
  height:48px;
  border-radius:50%;
  object-fit:cover;
  border:2px solid #fff;
  animation: avatarPulse 3s ease-in-out infinite;
  transition: transform .18s ease, box-shadow .18s ease;
  will-change: transform, box-shadow;
}
#chatWidget:hover .widget-avatar{
  transform: scale(1.08);
  box-shadow: 0 12px 28px rgba(93,185,150,0.18);
}

/* Keyframes */
@keyframes widgetFloat{
  0%   { transform: translateY(0); }
  50%  { transform: translateY(-6px); }
  100% { transform: translateY(0); }
}
@keyframes widgetWiggle{
  0%   { transform: translateY(-2px) rotate(-1deg); }
  25%  { transform: translateY(-6px) rotate(6deg); }
  50%  { transform: translateY(-4px) rotate(-4deg); }
  75%  { transform: translateY(-6px) rotate(4deg); }
  100% { transform: translateY(-2px) rotate(0deg); }
}
@keyframes widgetRing{
  0%   { transform: translate(-50%,-50%) scale(0.9); opacity: 0.9; }
  60%  { transform: translate(-50%,-50%) scale(1.35); opacity: 0.18; }
  100% { transform: translate(-50%,-50%) scale(1.6); opacity: 0; }
}
@keyframes avatarPulse{
  0%   { box-shadow: 0 0 0 0 rgba(93,185,150,0.12); transform: scale(1); }
  50%  { box-shadow: 0 10px 30px 6px rgba(93,185,150,0.08); transform: scale(1.03); }
  100% { box-shadow: 0 0 0 0 rgba(93,185,150,0.00); transform: scale(1); }
}


/* ================================================
   CHAT LINK STYLING - Button Style
   ================================================ */

.chat-link {
    /* Button-like appearance */
    display: inline-flex;
    align-items: center;
    gap: 6px;
    padding: 8px 16px;
    margin: 4px 2px;
    
    /* Colors and styling */
    background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);
    color: #157347;
    border: 2px solid #5DB996;
    border-radius: 20px;
    
    /* Typography */
    font-weight: 600;
    font-size: 13px;
    text-decoration: none;
    line-height: 1.4;
    
    /* Effects */
    box-shadow: 0 2px 8px rgba(93, 185, 150, 0.15);
    transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
    cursor: pointer;
    
    /* Ensure it doesn't break layout */
    max-width: 100%;
    word-break: break-word;
    white-space: normal;
}

/* Icon before link (arrow or external link icon) */
.chat-link::before {
    content: 'üîó';
    font-size: 14px;
    opacity: 0.8;
    flex-shrink: 0;
}

/* For external links, use different icon */
.chat-link[target="_blank"]::before {
    content: '‚Üó';
    font-weight: bold;
}

/* For phone links */
.chat-link[href^="tel:"]::before {
    content: 'üìû';
}

/* For email links */
.chat-link[href^="mailto:"]::before {
    content: '‚úâÔ∏è';
}

/* Hover state - lift and brighten */
.chat-link:hover {
    background: linear-gradient(135deg, #5DB996 0%, #4a9d7f 100%);
    color: #ffffff;
    border-color: #157347;
    transform: translateY(-2px);
    box-shadow: 0 6px 16px rgba(93, 185, 150, 0.3);
}

/* Active state - press down */
.chat-link:active {
    transform: translateY(0);
    box-shadow: 0 2px 6px rgba(93, 185, 150, 0.2);
}

/* Visited state - slightly muted but still visible */
.chat-link:visited {
    border-color: #7ec4a8;
    opacity: 0.9;
}

.chat-link:visited:hover {
    opacity: 1;
    background: linear-gradient(135deg, #5DB996 0%, #4a9d7f 100%);
    color: #ffffff;
}

/* Focus state for accessibility */
.chat-link:focus {
    outline: 3px solid rgba(93, 185, 150, 0.4);
    outline-offset: 2px;
}

/* Special styling for links in bot messages */
.msg.bot .chat-link {
    background: linear-gradient(135deg, #ffffff 0%, #f0fdf4 100%);
    border-color: rgba(255, 255, 255, 0.6);
    color: #1e38bb;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
}

.msg.bot .chat-link:hover {
    background: linear-gradient(135deg, #ffffff 0%, #ffffff 100%);
    color: #157347;
    border-color: #ffffff;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
}

/* Special styling for links in user messages */
.msg.user .chat-link {
    background: linear-gradient(135deg, #157347 0%, #0f5a38 100%);
    color: #ffffff;
    border-color: rgba(21, 115, 71, 0.6);
}

.msg.user .chat-link:hover {
    background: linear-gradient(135deg, #0f5a38 0%, #0a4428 100%);
    border-color: #157347;
}

/* Responsive adjustments */
@media (max-width: 480px) {
    .chat-link {
        padding: 10px 14px;
        font-size: 14px;
        margin: 6px 2px;
        /* Make links easier to tap on mobile */
        min-height: 44px;
    }
    
    .chat-link::before {
        font-size: 16px;
    }
}

/* Animation for new links */
@keyframes linkAppear {
    from {
        opacity: 0;
        transform: scale(0.95);
    }
    to {
        opacity: 1;
        transform: scale(1);
    }
}

.chat-link {
    animation: linkAppear 0.3s ease-out;
}



/* End of consolidated CSS */